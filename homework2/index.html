<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Homework 2 - Dataset e Distribuzioni Statistiche</title>
  <meta name="description" content="Esempio interattivo di dataset e distribuzioni statistiche, con cifrario di Cesare e decodifica linguistica in italiano e in inglese." />
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --muted: #9aa6b2;
      --accent: #7dd3fc;
      --radius: 14px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      color: #e6eef6;
      line-height: 1.6;
    }
    .wrap { max-width: 950px; margin: 0 auto; padding: 20px; }
    header { text-align: center; margin: 40px 0 30px; }
    h1 { color: var(--accent); font-size: 2rem; }
    p.lead { color: var(--muted); font-size: 1rem; margin-top: 8px; }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }
    h2 { color: var(--accent); margin-bottom: 10px; font-size: 1.3rem; }
    canvas, table {
      margin-top: 10px;
      width: 100%;
      color: white;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      text-align: center;
    }
    th, td {
      padding: 8px;
      border: 1px solid #444;
    }
    th { background: var(--accent); color: #000; }
    td { background: #1a2233; }
    input, select, textarea, button {
      margin-top: 8px;
      padding: 8px;
      border-radius: 8px;
      border: none;
      background: #1c2738;
      color: #e6eef6;
      width: 100%;
    }
    button {
      background: var(--accent);
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: #a5e5ff; }
    .white-text { color: #fff !important; font-weight: bold; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Dataset e Distribuzioni Statistiche</h1>
      <p class="lead">Un percorso interattivo tra concetti e applicazioni pratiche.</p>
    </header>

    <!-- Sezione 1: Cos’è un dataset -->
    <div class="card">
      <h2>1. Cos’è un Dataset</h2>
      <p>Un <strong>dataset</strong> è una raccolta strutturata di dati. Può contenere numeri, parole, misurazioni o osservazioni. Ogni riga rappresenta un’osservazione, mentre le colonne rappresentano variabili o attributi.</p>
      <p>Esempio: un dataset sulle vendite in tre paesi:</p>
      <table id="datasetTable"></table>
    </div>

    <!-- Sezione 2: Cos’è una Distribuzione -->
    <div class="card">
      <h2>2. Cos’è una Distribuzione Statistica</h2>
      <p>Una <strong>distribuzione</strong> descrive come si presentano i valori di una variabile. Può essere rappresentata come tabella o istogramma che mostra quanto frequentemente ogni valore compare nel dataset.</p>
    </div>

    <!-- Sezione 3: Distribuzione univariata -->
    <div class="card">
      <h2>3. Distribuzione univariata</h2>
      <p>Calcoliamo la distribuzione per la variabile <strong>Vendite</strong> nei primi 3 paesi.</p>
      <table id="univariateTable"></table>
    </div>

    <!-- Sezione 4: Distribuzione bivariata -->
    <div class="card">
      <h2>4. Distribuzione bivariata</h2>
      <p>Confrontiamo due variabili: <strong>Paese</strong> e <strong>Vendite</strong>.</p>
      <table id="bivariateTable"></table>
    </div>

    <!-- Sezione 5: Distribuzione di lettere -->
    <div class="card">
      <h2>5. Distribuzione delle lettere + Cifrario di Cesare</h2>
      <p>Inserisci un testo, calcola la distribuzione delle lettere, applica il cifrario e prova a decifrare.</p>

      <textarea id="textInput" rows="3" placeholder="Scrivi qualcosa..."></textarea>
      <label for="shiftInput">Shift (spostamento lettere):</label>
      <input type="number" id="shiftInput" value="3" min="1" max="25">
      <button onclick="applyCaesar()">Applica Cifrario di Cesare</button>
      <textarea id="encryptedOutput" rows="3" readonly placeholder="Testo cifrato"></textarea>
      <button onclick="bruteForce()">Decodifica per forza bruta</button>
      <textarea id="bruteOutput" rows="3" readonly placeholder="Risultato decodifica brute force"></textarea>

      <label for="langSelect">Decodifica per distribuzione linguistica:</label>
      <select id="langSelect">
        <option value="it" selected>Italiano</option>
        <option value="en">English</option>
      </select>
      <button onclick="languageDecrypt()">Decodifica per linguaggio</button>
      <textarea id="langOutput" rows="3" readonly placeholder="Risultato decodifica linguistica"></textarea>

      <table id="letterTable"></table>
    </div>

    <footer><p class="muted">© 2025 – Demo educativa di statistica applicata e crittografia.</p></footer>
  </div>

  <script>
    // === DATI E TABELLE BASE ===
    const dataset = [
      { paese: "Italia", vendite: 120 },
      { paese: "Francia", vendite: 150 },
      { paese: "Spagna", vendite: 100 },
      { paese: "Italia", vendite: 80 },
      { paese: "Francia", vendite: 130 },
      { paese: "Spagna", vendite: 90 }
    ];

    function renderDataset() {
      const t = document.getElementById("datasetTable");
      t.innerHTML = "<tr><th>Paese</th><th>Vendite</th></tr>" +
        dataset.map(d => `<tr><td>${d.paese}</td><td class='white-text'>${d.vendite}</td></tr>`).join("");
    }

    function renderUnivariate() {
      const subset = dataset.slice(0, 3);
      const t = document.getElementById("univariateTable");
      t.innerHTML = "<tr><th>Paese</th><th>Vendite</th></tr>" +
        subset.map(d => `<tr><td>${d.paese}</td><td class='white-text'>${d.vendite}</td></tr>`).join("");
    }

    function renderBivariate() {
      const grouped = {};
      dataset.forEach(d => { grouped[d.paese] = (grouped[d.paese] || 0) + d.vendite; });
      const t = document.getElementById("bivariateTable");
      t.innerHTML = "<tr><th>Paese</th><th>Somma Vendite</th></tr>" +
        Object.entries(grouped).map(([p, v]) => `<tr><td>${p}</td><td class='white-text'>${v}</td></tr>`).join("");
    }

    // === CIFRARIO DI CESARE E DECODIFICHE ===
    function applyCaesar() {
      const text = document.getElementById("textInput").value.toUpperCase();
      const shift = parseInt(document.getElementById("shiftInput").value);
      const encrypted = text.replace(/[A-Z]/g, c =>
        String.fromCharCode((c.charCodeAt(0) - 65 + shift) % 26 + 65)
      );
      document.getElementById("encryptedOutput").value = encrypted;
      renderLetterDistribution(encrypted);
    }

    function bruteForce() {
      const cipher = document.getElementById("encryptedOutput").value;
      let best = "";
      for (let s = 1; s < 26; s++) {
        const dec = cipher.replace(/[A-Z]/g, c =>
          String.fromCharCode((c.charCodeAt(0) - 65 - s + 26) % 26 + 65)
        );
        best += `Shift ${s}: ${dec}\n`;
      }
      document.getElementById("bruteOutput").value = best;
    }

    const langFreq = {
      en: { A: 8.2, B: 1.5, C: 2.8, D: 4.3, E: 12.7, F: 2.2, G: 2.0, H: 6.1, I: 7.0, J: 0.2, K: 0.8, L: 4.0, M: 2.4, N: 6.7, O: 7.5, P: 1.9, Q: 0.1, R: 6.0, S: 6.3, T: 9.1, U: 2.8, V: 1.0, W: 2.4, X: 0.2, Y: 2.0, Z: 0.1 },
      it: { A: 11.7, B: 0.9, C: 4.5, D: 3.7, E: 11.8, F: 1.1, G: 1.6, H: 0.6, I: 10.1, L: 6.5, M: 2.5, N: 6.9, O: 9.8, P: 3.0, Q: 0.5, R: 6.4, S: 5.4, T: 6.2, U: 3.0, V: 2.1, Z: 1.1 }
    };

    function languageDecrypt() {
      const cipher = document.getElementById("encryptedOutput").value;
      const lang = document.getElementById("langSelect").value;
      let bestShift = 0, bestScore = Infinity;

      for (let s = 0; s < 26; s++) {
        const dec = cipher.replace(/[A-Z]/g, c =>
          String.fromCharCode((c.charCodeAt(0) - 65 - s + 26) % 26 + 65)
        );

        const freq = {};
        for (let ch of dec)
          if (/[A-Z]/.test(ch)) freq[ch] = (freq[ch] || 0) + 1;
        const total = Object.values(freq).reduce((a, b) => a + b, 0) || 1;

        let score = 0;
        for (const [k, v] of Object.entries(langFreq[lang]))
          score += Math.abs((freq[k] || 0) / total * 100 - v);

        if (score < bestScore) { bestScore = score; bestShift = s; }
      }

      const decrypted = cipher.replace(/[A-Z]/g, c =>
        String.fromCharCode((c.charCodeAt(0) - 65 - bestShift + 26) % 26 + 65)
      );

      document.getElementById("langOutput").value = decrypted;
    }

    // === DISTRIBUZIONE LETTERE ===
    function renderLetterDistribution(text) {
      const freq = {};
      for (let c of text)
        if (/[A-Z]/.test(c)) freq[c] = (freq[c] || 0) + 1;

      const total = Object.values(freq).reduce((a, b) => a + b, 0) || 1;
      const t = document.getElementById("letterTable");
      t.innerHTML = "<tr><th>Lettera</th><th>Occorrenze</th><th>%</th></tr>" +
        Object.entries(freq)
          .sort()
          .map(([ch, val]) => `<tr><td>${ch}</td><td class='white-text'>${val}</td><td class='white-text'>${((val / total) * 100).toFixed(2)}%</td></tr>`)
          .join("");
    }

    renderDataset();
    renderUnivariate();
    renderBivariate();
  </script>
</body>
</html>
